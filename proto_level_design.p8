pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--portal
portal_1={
    init=function(self)
        self.spr1=3
        self.spr2=4
        self.x1=4*8
        self.y1=8*8
        self.x2=21*8
        self.y2=22*8
    end 
}
-->8
--player
player={
    init=function(self)
        self.spr=1
        self.x=30
        self.y=30
        self.offx=1
        self.offy=1
        self.width=6
        self.height=6
        self.vecx=0
        self.vecy=0
        self.arrrow_spr=2
        self.arrow_x=self.x
        self.arrow_y=self.y
        self.arrow_angle=1
        self.arrow_radius=10
    end,

    update=function(self)
        --player


        if (btn(⬆️)) then
            self.vecx=self.arrow_x-self.x
            self.vecy=self.arrow_y-self.y
            self.x+=self.vecx/15
            self.y+=self.vecy/15
            teleport(self, portal_1)
        end

        --arrow
        if (btn(⬅️)) then self.arrow_angle+=5 end
        if (btn(➡️)) then self.arrow_angle-=5 end
        self.arrow_angle=self.arrow_angle%360
        self.arrow_x=self.x+self.arrow_radius*cos(self.arrow_angle/360)
        self.arrow_y=self.y+self.arrow_radius*sin(self.arrow_angle/360)

    end,

    draw=function(self)
        spr(self.spr, self.x, self.y)
        spr(self.arrrow_spr,self.arrow_x, self.arrow_y)
    end
}

-->8
--tool
function teleport(obj, portal)
    if (obj.x+8>=portal.x1 and obj.x<=portal.x1+8 and obj.y+8>=portal.y1 and obj.y<=portal.y1+8) then
        local diffx = obj.x - portal.x1
        local diffy = obj.y - portal.y1
        obj.x = portal.x2 - diffx*1.1
        obj.y = portal.y2 - diffy*1.1
        printh(portal.x2 - diffx)
    elseif (obj.x+8>=portal.x2 and obj.x<=portal.x2+8 and obj.y+8>=portal.y2 and obj.y<=portal.y2+8) then
        local diffx = obj.x - portal.x2
        local diffy = obj.y - portal.y2
        obj.x = portal.x1 - diffx*1.1
        obj.y = portal.y1 - diffy*1.1
    end
end

-->8
--tools
focus_camera = {
    init=function(this, focx, focy)
        this.x = 0
        this.y = 0
        this.focus_x=focx or 0
        this.focus_y=focy or 0

    end,

    update=function(this, focx, focy)
        this.x=this.x + (focx - this.x)/20
        this.y=this.y + (focy - this.y)/20
    end,

    draw=function(this)
        camera(this.x-64, this.y-64)
    end
}
function draw_star()
    local tab_star={}
    for i=0, 102, 1 do 
        tab_star[i]={}
        for j=0, 51, 1 do 
            if (flr(rnd(4)) >= 3) then 
                tab_star[i][j] = true
                printh("test")
            else 
                tab_star[i][j] = false
            end         
        end
    end
    return tab_star
end

-->8
--main


function _init()
    player:init()
    portal_1:init()
    focus_camera:init(player.x, player.y)
    camx=0
    camy=0
end

function _update60()
    player:update()
    focus_camera:update(player.x, player.y)
end

function _draw()
    cls()
    map(0,0)
    player:draw()
    focus_camera:draw()
    spr(portal_1.spr1, portal_1.x1, portal_1.y1)
    spr(portal_1.spr2, portal_1.x2, portal_1.y2)
end


__gfx__
00000000000000000000000000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000660000000000000065100000651000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000677600000cc00001155100011551000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000677776000c77c0015522560155cc5600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000677776000c77c0006522551065cc5510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000677600000cc00000155110001551100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000660000000000000156000001560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000010000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1be237b7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1beb9707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
12eb970e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e9eb971e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e97b971e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e97027e9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09702eb9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09702ebe000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00005500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00055560700000000555500007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00055550000007005555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00056550000000005565556000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00005500000000005676556000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05000000000000005565555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
56500000070000005555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05000000000000000055550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333330303333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333313333333333333333333233333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333133333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333323333333331313333333133333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333332333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333033333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333323333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333323333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333332333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333323333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
